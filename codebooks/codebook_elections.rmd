---
title: "Codebook bundeslaendeR Election Data"
author: "Robert Stelzle"
date: "15 1 2022"
output:
  pdf_document:
    keep_tex: true
header-includes:
  - \usepackage{longtable}
  - \usepackage{float}
  - \usepackage{graphicx}
---

```{r include=FALSE}
library(tidyverse)
library(bundeslaendeR)
library(kableExtra)
library(patchwork)
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(fig.align="center",
                      fig.width = 5)
```

```{r}
# Design des longtables low key von Werner Krause geklaut

item_start <- function(item_name_code, item_name, item_desc, desc_left = FALSE) {
  item_name_code <- str_replace_all(item_name_code, pattern = r"{_}", replacement = r"{\\_}")
  cat("\\begin{longtable}{p{3.2cm}| p{11cm}}")
  cat("\n")
  cat(paste0("\\texttt{", item_name_code, "} &"))
  cat(paste0("\\textbf{", item_name, "}"))
  cat("\\newline \n")
  
  if (desc_left == FALSE) {
    cat(item_desc)
  }
  if (desc_left == TRUE) {
    cat("\\begin{flushleft}")
    cat(item_desc)
    cat("\n")
    cat("\\end{flushleft}")
    cat("\n")
  }
  
}


item_image <- function(ggobj, filenameimg, width, height) {
  
  ggsave(ggobj, filename = filenameimg, width = width, height = height)
  
  cat("\\hspace*{.25cm}")
  cat("\n")
  cat("\\begin{minipage}[t]{\\linewidth }")
  cat("\n")
  cat("\\vspace{0pt}")
  cat("\n")
  cat("\\includegraphics[width = \\linewidth]{")
  cat(filenameimg)
  cat("}")
  cat("\n")
  cat("\\end{minipage}")
  
}


item_end <- function(add_desc = "") {
  cat(add_desc)
  cat("\n")
  cat("\\end{longtable}")
  
}



short_item <- function(item_name_code, item_name, item_desc, desc_left = FALSE) {
  
  item_name_code <- str_replace_all(item_name_code, pattern = r"{_}", replacement = r"{\\_}")
  cat("\\begin{longtable}{p{3.2cm}| p{11cm}}")
  cat("\n")
  cat(paste0("\\texttt{", item_name_code, "} &"))
  cat(paste0("\\textbf{", item_name, "}"))
  cat("\\newline \n")
  
  if (desc_left == FALSE) {
    cat(item_desc)
  }
  if (desc_left == TRUE) {
    cat("\\begin{flushleft}")
    cat(item_desc)
    cat("\n")
    cat("\\end{flushleft}")}
    cat("\n")
    cat("\\end{longtable}")
  
}


```



## `ltw_election_results`

`bundeslaendeR::ltw_election_results` returns data frame (tibble if the tibble
package is loaded) containing one row per contesting party per election.

Most election results data are provided by the Bundeswahlleiter.
A machine-readable version of the Bundeswahlleiter's compiled data contained in
the -periodically published- pdf available here
(\url{https://www.bundeswahlleiter.de/service/landtagswahlen.html}) was kindly
provided to me.
Election data outside the timeframe covered by Bundeswahlleiter's data provided
to me was collected from the states' local election authorities'
(Landeswahlleiter) websites.
More information on parties and the continuity of parties under different labels
was collected by me.

The Bundeswahlleiter's election data in many cases contains differing names for
the same party. Both between states (eg. "Christlich Demokratische Union
Deutschlands" vs. "Christlich Demokratische Union Deutschlands in
Niedersachsen") as well as within states between elections -in many cases due to
parties being renamed- ("BÜNDNIS 90/DIE GRÜNEN, Landesverband Hamburg,
Grün-Alternative Liste" vs. "BÜNDNIS 90/DIE GRÜNEN, Landesverband Hamburg").
Efforts were made to reconcile both of these inconsistencies by adding two new,
harmonized variables identifying parties (`partyname_short` and `partyname`).
This harmonized party identifier also covers merging of parties. The partyname
given to the resulting party (eg. "Linke", "Grüne") is given to the largest of
the preceding parties contesting an election unless a smaller party joined a
government following the election.
The original names provided by the Bundeswahlleiter (and Landeswahlleiters in 
elections after June 2021) are still available
(`partyname_short_bundeswahlleiter` and `partyname_bundeswahlleiter`).

\newpage

# Variables

```{r, results="asis"}
short_item(item_name_code = "state",
           item_name = "State Abbreviation",
           item_desc = "ISO 3166-2:DE-code of the state;
           including BA for the former state of Baden, WH for the former state
           of Württemberg-Hohenzollern and WB for the former state of
           Württemberg-Baden.",
           desc_left = FALSE)
```






```{r, results="asis"}
short_item(item_name_code = "nuts1",
           item_name = "NUTS1 Code of State",
           item_desc = "NUTS1 code of state. NA for former states Baden, Württemberg-Baden, Württemberg-Hohenzollern.",
           desc_left = FALSE)
```

```{r, results="asis"}
short_item(item_name_code = "state_name_de",
           item_name = "German Name of State",
           item_desc = "German name of the state.",
           desc_left = FALSE)
```

```{r, results="asis"}
short_item(item_name_code = "state_name_en",
           item_name = "English Name of State.",
           item_desc = "English name of the state.",
           desc_left = FALSE)
```


```{r state_variables_table, results='asis'}

ltw_election_results %>% 
  count(state, nuts1, state_name_de, state_name_en) %>% 
  kable(booktabs = TRUE,
        caption = "Overview of state level variables")

```



```{r, results="asis"}
item_start(item_name_code = "state_election_\nterm",
           item_name = "Election Term of State",
           item_desc = "Election term in the state. Counts up from 1.",
           desc_left = FALSE)
```



```{r, results="asis"}
electiontermplot <- 
ltw_election_results %>% 
  select(state_election_term, election_date, state) %>%
  distinct() %>% 
  ggplot(aes(x = state_election_term)) +
    geom_bar() +
    scale_y_continuous(breaks= scales::pretty_breaks()) +
    theme_minimal() +
    labs(x = "State Election Term", y = "N")

item_image(ggobj = electiontermplot,
           filenameimg = "cbelec/electiontermplot.pdf",
           width = 5,
           height = 5/3)

```




```{r, results="asis"}
item_end()
```





```{r, results="asis"}
item_start(item_name_code = "election_date",
           item_name = "Election Date",
           item_desc = "Date of the election.  ISO 8601 or R-Date format.",
           desc_left = FALSE)

```

```{r, results="asis"}
electiondatesplot <- 
ltw_election_results %>% 
  select(election_date, state) %>%
  distinct() %>% 
  mutate(year = lubridate::year(election_date)) %>% 
  count(year) %>% 
  ggplot(aes(x = year, y = n)) +
    geom_col() +
    scale_y_continuous(breaks= scales::pretty_breaks()) +
    scale_x_continuous(breaks= scales::pretty_breaks()) +
    theme_minimal() +
    labs(x = "Year", y = "N")


item_image(ggobj = electiondatesplot,
           filenameimg = "cbelec/electiondatesplot.pdf",
           width = 5,
           height = 5/3)
```

```{r, results="asis"}
item_end()
```




```{r, results="asis"}
short_item(item_name_code = "election_id_\nbundeswahlleiter",
           item_name = "Election ID Bundeswahlleiter",
           item_desc = "Specific election\\_id as denoted by the Bundeswahlleiter. Note that BA, WH and WH are named as BW and the number counts down. NA for cases taken from Landeswahlleiters (ie elections after ST 2021).",
           desc_left = FALSE)
```

```{r, results="asis"}
short_item(item_name_code = "election_remarks_\nbundeswahlleiter",
           item_name = "Election Remarks Bundeswahlleiter",
           item_desc = "Remarks on the election as given by the Bundeswahlleiter.",
           desc_left = FALSE)
```





```{r, results="asis"}
item_start(item_name_code = "electorate",
           item_name = "Size of the Electorate",
           item_desc = "Number of eligible voters. For more totals also see the last three columns.",
           desc_left = FALSE)

```

```{r, results="asis"}
electorateplot <-
ltw_election_results %>% 
  select(electorate, state, state_election_term) %>% 
  distinct() %>% 
  ggplot(aes(x = electorate)) +
    geom_histogram(bins = 20) +
    scale_x_continuous(labels = scales::comma) +
    theme_minimal() +
    labs(x = "Size of the Electorate", y = "N")


item_image(ggobj = electorateplot,
           filenameimg = "cbelec/electorateplot.pdf",
           width = 5,
           height = 5/3)
```

```{r, results="asis"}
item_end()
```




```{r, results="asis"}
item_start(item_name_code = "number_of_voters",
           item_name = "Number of Voters",
           item_desc = "Number of voters turning out. For more totals also see the last three columns.",
           desc_left = FALSE)

```

```{r, results="asis"}
nvotersplot <-
ltw_election_results %>% 
  select(number_of_voters, state, state_election_term) %>% 
  distinct() %>% 
  filter(!is.na(number_of_voters)) %>% 
  ggplot(aes(x = number_of_voters)) +
    geom_histogram(bins = 20) +
    scale_x_continuous(labels = scales::comma) +
    theme_minimal() +
    labs(x = "Number of Voters", y = "N",
         caption = "One missing observation: 1946 HB election.")


item_image(ggobj = nvotersplot,
           filenameimg = "cbelec/nvotersplot.pdf",
           width = 5,
           height = 5/3)
```

```{r, results="asis"}
item_end()
```


```{r, results="asis"}
item_start(item_name_code = "turnout",
           item_name = "Turnout",
           item_desc = "Turnout. Share of eligible voters turning out.",
           desc_left = FALSE)

```

```{r, results="asis"}
turnoutplot <-
ltw_election_results %>% 
  select(turnout, state, state_election_term) %>% 
  distinct() %>% 
  filter(!is.na(turnout)) %>%
  ggplot(aes(x = turnout)) +
    geom_histogram(bins = 20) +
    scale_x_continuous(labels = scales::comma) +
    theme_minimal() +
    labs(x = "Turnout", y = "N",
         caption = "One missing observation: 1946 HB election.")


item_image(ggobj = turnoutplot,
           filenameimg = "cbelec/turnoutplot.pdf",
           width = 5,
           height = 5/3)
```

```{r, results="asis"}
item_end()
```
 

```{r, results="asis"}
item_start(item_name_code = "valid_votes",
           item_name = "Valid Votes",
           item_desc = "Number of valid votes. Does not have to be equal to the number of ballots cast, as sometimes a ballot contains multiple votes! For more totals also see the last three columns.",
           desc_left = FALSE)

```

```{r, results="asis"}
validvoteplot <-
ltw_election_results %>% 
  select(valid_votes, state, state_election_term) %>% 
  distinct() %>% 
  # filter(!is.na(valid_votes)) %>%
  ggplot(aes(x = valid_votes)) +
    geom_histogram(bins = 20) +
    scale_x_continuous(labels = scales::comma) +
    theme_minimal() +
    labs(x = "Valid Votes", y = "N")


item_image(ggobj = validvoteplot,
           filenameimg = "cbelec/validvoteplot.pdf",
           width = 5,
           height = 5/3)
```

```{r, results="asis"}
item_end()
```




```{r, results="asis"}
item_start(item_name_code = "total_seats_\nparliament",
           item_name = "Total Seats in Parliament",
           item_desc = "Total number of members of the newly elected Landtag.",
           desc_left = FALSE)

```

```{r, results="asis"}
tseatsparlplot <-
ltw_election_results %>% 
  select(total_seats_parliament, state, state_election_term) %>% 
  distinct() %>% 
  # filter(!is.na(valid_votes)) %>%
  ggplot(aes(x = total_seats_parliament)) +
    geom_histogram(bins = 20) +
    scale_x_continuous(labels = scales::comma) +
    theme_minimal() +
    labs(x = "Total Seats in Parliament", y = "N")


item_image(ggobj = tseatsparlplot,
           filenameimg = "cbelec/tseatsparlplot.pdf",
           width = 5,
           height = 5/3)
```

```{r, results="asis"}
item_end()
```



```{r, results="asis"}
item_start(item_name_code = "female_party_\nseats_available",
           item_name = "Number of female MdLs available per party",
           item_desc = "Denotes whether information on the no. of female members of the Landtag per party is available for this election. Note that for parties not elected to the new Landtag party\\_female\\_mps always is.na() == TRUE.",
           desc_left = FALSE)

```

```{r, results="asis"}
fpsaplot <-
ltw_election_results %>% 
  select(female_party_seats_available, state, state_election_term) %>% 
  distinct() %>% 
  ggplot(aes(y = female_party_seats_available)) +
    geom_bar() +
    theme_minimal() +
    labs(x = "Number of Elections", y = "Number of female\nMdLs available\nper party")

item_image(ggobj = fpsaplot,
           filenameimg = "cbelec/fpsaplot.pdf",
           width = 5,
           height = 5/3)
```

```{r, results="asis"}
item_end()
```





```{r, results="asis"}
item_start(item_name_code = "total_female_\nmps_parliament",
           item_name = "Number of Female MPs in Parliament",
           item_desc = "Number of newly elected female MPs.",
           desc_left = FALSE)

```

```{r, results="asis"}
totfemmpsplot <-
ltw_election_results %>% 
  select(total_female_mps_parliament, state, state_election_term) %>% 
  distinct() %>% 
  filter(!is.na(total_female_mps_parliament)) %>% 
  select(total_female_mps_parliament) %>% 
  mutate(total_female_mps_parliament = mltools::bin_data(total_female_mps_parliament,
                                                         bins = 15) %>%
                                        as.character()) %>% 
  mutate(lb = str_extract(string = total_female_mps_parliament,pattern = "(?<=\\[).*?(?=,)") %>% as.numeric() %>% round(1)) %>% 
  mutate(ub = str_extract(string = total_female_mps_parliament,pattern = "(?<=, )(.*)(?=\\)|])") %>% as.numeric()%>% round(1)) %>% 
  mutate(int = case_when(
    ub == max(ub) ~ paste0("[", lb, ",", ub, "]"),
    TRUE ~ paste0("[", lb, ",", ub, ")")
  )) %>% 
  mutate(int = as_factor(int) %>% fct_reorder(lb) %>% fct_expand("NA")) %>% 
  count(int) %>% 
  bind_rows(
    tibble(
      int = as_factor("NA"),
      n = ltw_election_results %>% 
          select(total_female_mps_parliament, state, state_election_term) %>% 
          distinct() %>% 
          filter(is.na(total_female_mps_parliament)) %>% 
          nrow()
    )
  ) %>% 
  ggplot(aes(x = int, y= n)) +
    geom_col() +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
    labs(x = "Number of newly elected female MPs", y = "N")
  

  



item_image(ggobj = totfemmpsplot,
           filenameimg = "cbelec/totfemmpsplot.pdf",
           width = 5,
           height = 5/3)
```

```{r, results="asis"}
item_end()
```








```{r, results="asis"}
short_item(item_name_code = "partyname_short",
           item_name = "Abbreviated Party Name",
           item_desc = paste("Harmonized abbreviation of the party's name.", 
                             length(unique(ltw_election_results$partyname_short)),
                             "unique parties."),
           desc_left = FALSE)
```



```{r, results="asis"}
short_item(item_name_code = "partyname",
           item_name = "Party Name",
           item_desc = paste("Harmonized name of the party.", 
                             length(unique(ltw_election_results$partyname_short)),
                             "unique parties."),
           desc_left = FALSE)
```

```{r, results="asis"}
short_item(item_name_code = "partyname_short_\nbundeswahlleiter",
           item_name = "Party Name Abbreviation from Bundeswahlleiter",
           item_desc = paste("Partyname abbreviation as documented by the Bundeswahlleiter.", 
                             length(unique(ltw_election_results$partyname_short_bundeswahlleiter)),
                             "different abbreviations."),
           desc_left = FALSE)
```

```{r, results="asis"}
short_item(item_name_code = "partyname_\nbundeswahlleiter",
           item_name = "Party Name from Bundeswahlleiter",
           item_desc = paste("Partyname as documented by the Bundeswahlleiter.", 
                             length(unique(ltw_election_results$partyname_bundeswahlleiter)),
                             "different names."),
           desc_left = FALSE)
```




```{r, results="asis"}
item_start(item_name_code = "party_vote_count",
           item_name = "Party Vote Count",
           item_desc = "Number of votes recieved by the party.",
           desc_left = FALSE)

```

```{r, results="asis"}
pvcplot <-
ltw_election_results %>% 
  select(party_vote_count, state, state_election_term) %>% 
  filter(party_vote_count > 0) %>% 
  ggplot(aes(x = party_vote_count)) +
    geom_histogram(bins = 20) +
    scale_x_log10(labels = scales::comma) +
    theme_minimal() +
    labs(x = "Number of votes recieved by party\n(Plotted on log10 scale)", y = "N")


item_image(ggobj = pvcplot,
           filenameimg = "cbelec/pvcplot.pdf",
           width = 5,
           height = 5/2.5)
```

```{r, results="asis"}
item_end()
```



```{r, results="asis"}
item_start(item_name_code = "party_vshare",
           item_name = "Party Vote Share",
           item_desc = "Share of votes recieved by the party.",
           desc_left = FALSE)

```

```{r, results="asis"}
pvsplot <-
ltw_election_results %>% 
  select(party_vshare, state, state_election_term) %>% 
  filter(party_vshare > 0) %>% 
  ggplot(aes(x = party_vshare)) +
    geom_histogram(bins = 20) +
    scale_x_continuous(breaks = seq(0,1,0.05), labels = scales::percent) +
    # theme(axis.text.x = element_text(90)) +
    theme_minimal() +
    labs(x = "Share of votes recieved by the party", y = "N")


item_image(ggobj = pvsplot,
           filenameimg = "cbelec/pvsplot.pdf",
           width = 6.5,
           height = 6/3.9)
```

```{r, results="asis"}
item_end()
```


```{r, results="asis"}
item_start(item_name_code = "party_seat_count",
           item_name = "Party Seat Count",
           item_desc = "Number of seats recieved by the party.",
           desc_left = FALSE)

```

```{r, results="asis"}
xlabstring <- 
paste0("Number of seats recieved by the party\n(",
ltw_election_results %>% 
  filter(party_seat_count > 0) %>% 
  pull(party_seat_count) %>%
  length(), " parties without seats not plotted)")
  


pscplot <-
ltw_election_results %>% 
  select(party_seat_count, state, state_election_term) %>% 
  filter(party_seat_count > 0) %>%
  ggplot(aes(x = party_seat_count)) +
    geom_histogram(bins = 30) +
    scale_x_continuous(breaks = seq(1,max(ltw_election_results$party_seat_count),5)) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45)) +
    labs(x = xlabstring, y = "N")


item_image(ggobj = pscplot,
           filenameimg = "cbelec/pscplot.pdf",
           width = 5,
           height = 5/3)
```

```{r, results="asis"}
item_end()
```



```{r, results="asis"}
item_start(item_name_code = "party_sshare",
           item_name = "Party Seat Share",
           item_desc = "Share of seats recieved by the party.",
           desc_left = FALSE)

```

```{r, results="asis"}
xlabstring <-
paste0("Share of seats recieved by the party\n(",
ltw_election_results %>% 
  filter(party_sshare > 0) %>% 
  pull(party_sshare) %>%
  length(), " parties without seats not plotted)")
  


pssplot <-
ltw_election_results %>% 
  select(party_sshare, state, state_election_term) %>% 
  filter(party_sshare > 0) %>%
  ggplot(aes(x = party_sshare)) +
    geom_histogram(bins = 30) +
    scale_x_continuous(breaks = seq(0.01,max(ltw_election_results$party_sshare),0.05),
                       labels = scales::percent) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45)) +
    labs(x = xlabstring, y = "N")


item_image(ggobj = pssplot,
           filenameimg = "cbelec/pssplot.pdf",
           width = 5,
           height = 5/2.5)
```

```{r, results="asis"}
item_end()
```




```{r, results="asis"}
item_start(item_name_code = "party_female_mps",
           item_name = "Number of female MPs from party",
           item_desc = "Number of female MPs elected for the party. Note that for parties not elected to the new Landtag party\\_female\\_mps always is.na() == TRUE.",
           desc_left = FALSE)

```

```{r, results="asis"}

wbarplot <- 
ltw_election_results %>% 
  select(party_seat_count, party_female_mps, female_party_seats_available) %>% 
  mutate(reason = case_when(
    party_female_mps == 0 ~ "Party in parliament, no women",
    party_seat_count > 0 & female_party_seats_available == FALSE ~ "Party in parl. but no information about women",
    party_seat_count == 0 ~ "Party not in parliament",
    party_female_mps > 0 ~ "There are female MPs"
    )) %>% count(reason) %>%
  mutate(reason = as_factor(reason) %>% fct_reorder(n)) %>% 
  ggplot(aes(y = reason, x = n)) +
    geom_col() +
    theme_minimal() +
    labs(x = "N", y = NULL)




whist <-
ltw_election_results %>% 
  select(party_female_mps, state, state_election_term, party_sshare) %>% 
  filter(!is.na(party_female_mps)) %>% 
  filter(party_sshare > 0) %>%
  ggplot(aes(x = party_female_mps)) +
    geom_histogram(bins = 25) +
    scale_x_continuous(breaks= scales::pretty_breaks(n = 6)) +
    theme_minimal() +
    labs(x = "Number of female MPs from party", y = "N")
    

design <- "BBBBBBBBBBBBBB
           BBBBBBBBBBBBBB
           #AAAAAAAAAAAAA"

pfmpcplot <- 
wrap_plots(B = whist, A = wbarplot, design = design)


item_image(ggobj = pfmpcplot,
           filenameimg = "cbelec/pfmpcplot.pdf",
           width = 5,
           height = 5/1.7)
```

```{r, results="asis"}
item_end()
```





```{r, results="asis"}
item_start(item_name_code = "wzb_govelec_id", 
           item_name = "WZB DD GovElec ID",
           item_desc = "If available, MR-Code of the party in the internal govelec database of the WZB department Democracy and Democratization.")
```


```{r, results="asis"}
govelecplot <- 
ltw_election_results %>% 
  select(partyname_short, wzb_govelec_id) %>% 
  distinct() %>% 
  mutate(avail = !is.na(wzb_govelec_id)) %>% 
  count(avail) %>% 
  ggplot(aes(y = avail, x = n)) +
    geom_col() +
    theme_minimal() +
    labs(x = "Number of parties",
         y = "GovElec ID available")

item_image(ggobj = govelecplot,
           filenameimg = "cbelec/govelecplot.pdf",
           width = 5,
           height = 5/1.7)

```

```{r, results="asis"}
item_end()
```







```{r, results="asis"}
item_start(item_name_code = "ches_id", 
           item_name = "CHES ID",
           item_desc = "If available, ID of the party in the Chapel-Hill Expert Survey.")
```


```{r, results="asis"}
chesplot <- 
ltw_election_results %>% 
  select(partyname_short, ches_id) %>% 
  distinct() %>% 
  mutate(avail = !is.na(ches_id)) %>% 
  count(avail) %>% 
  ggplot(aes(y = avail, x = n)) +
    geom_col() +
    theme_minimal() +
    labs(x = "Number of parties",
         y = "CHES ID available")

item_image(ggobj = chesplot,
           filenameimg = "cbelec/chesplot.pdf",
           width = 5,
           height = 5/1.7)

```


```{r, results="asis"}
item_end()
```






```{r, results="asis"}
item_start(item_name_code = "partyfacts_id",
           item_name = "PartyFacts ID",
           item_desc = "If available, ID of the party in the partyfacts database.")
```

```{r, results="asis"}
partyfactsplot <- 
ltw_election_results %>% 
  select(partyname_short, partyfacts_id) %>% 
  distinct() %>% 
  mutate(avail = !is.na(partyfacts_id)) %>% 
  count(avail) %>% 
  ggplot(aes(y = avail, x = n)) +
    geom_col() +
    theme_minimal() +
    labs(x = "Number of parties",
         y = "PartyFacts ID available")

item_image(ggobj = chesplot,
           filenameimg = "cbelec/partyfactsplot.pdf",
           width = 5,
           height = 5/1.7)

```


```{r, results="asis"}
item_end()
```









```{r, results="asis"}
item_start(item_name_code = "decker_neu",
           item_name = "Chapter Parteienhandbuch",
           item_desc = "Denotes, wether the Handbuch der deutschen Parteien (3. ed.) by Decker and Neu has a chapter on the party.",
           desc_left = FALSE)
```

```{r, results="asis"}
deckerneuplot <- 
ltw_election_results %>% 
  select(partyname_short, decker_neu) %>% 
  distinct() %>% 
  mutate(avail = !is.na(decker_neu)) %>% 
  count(avail) %>% 
  ggplot(aes(y = avail, x = n)) +
    geom_col() +
    theme_minimal() +
    labs(x = "Number of parties",
         y = "Decker & Neu Chapter available")

item_image(ggobj = chesplot,
           filenameimg = "cbelec/deckerneuplot.pdf",
           width = 5,
           height = 5/1.7)

```


```{r, results="asis"}
item_end()
```








```{r, results="asis"}
short_item(item_name_code = "url_info",
           item_name = "URL with additional info on the party",
           item_desc = "URL to informaton on the party on the web. Can contain multiple URLs!",
           desc_left = FALSE)
```

```{r, results="asis"}
short_item(item_name_code = "party_remarks_\nstelzle",
           item_name = "Party remarks Stelzle",
           item_desc = "Remarks on the party by me.",
           desc_left = FALSE)
```

```{r, results="asis"}
short_item(item_name_code = "party_remarks_\nbundeswahlleiter",
           item_name = "Party remarks Bundeswahlleiter",
           item_desc = "Remarks on the party as listed by the Bundeswahlleiter.",
           desc_left = FALSE)
```

```{r, results="asis"}
short_item(item_name_code = "gueltige_stimm\n-zettel_hh_hb",
           item_name = "Gültige Stimmzettel HH and HB",
           item_desc = "Messy totals.",
           desc_left = FALSE)
```

```{r, results="asis"}
short_item(item_name_code = "gesamtstimmen_by",
           item_name = "Gesamtstimmen BY",
           item_desc = "Messy totals.",
           desc_left = FALSE)
```

```{r, results="asis"}
short_item(item_name_code = "ausgefallene_\nstimmen_be",
           item_name = "Ausgefallene Stimmen BE",
           item_desc = "Messy totals.",
           desc_left = FALSE)
```

```{r, results="asis"}
short_item(item_name_code = "abgegebene_\nstimmen_hh",
           item_name = "Abgegebene Stimmen HH",
           item_desc = "Messy totals.",
           desc_left = FALSE)
```

```{r, results="asis"}
short_item(item_name_code = "ungueltige_\nstimmen_except_\nhh_hb",
           item_name = "Ungültige Stimmen except in HH and HB",
           item_desc = "Messy totals.",
           desc_left = FALSE)
```

```{r, results="asis"}
short_item(item_name_code = "ungueltige_\nstimmzettel_hh_hb",
           item_name = "Ungültige Stimmzettel in HH and HB",
           item_desc = "Messy totals.",
           desc_left = FALSE)
```















